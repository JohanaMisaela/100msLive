import{__awaiter as r}from"../node_modules/tslib/tslib.es6.js";import{useRef as i,useCallback as e,useEffect as t}from"react";import{selectVideoTrackByID as o}from"@100mslive/hms-video-store";import{useHMSActions as d,useHMSStore as c}from"../primitives/HmsRoomProvider.js";import n from"../utils/logger.js";const u=({trackId:u,attach:l})=>{const v=d(),a=i(null),s=c(o(u)),m=i(),f=e((r=>{r&&(a.current=r)}),[]);return t((()=>{m.current?(null==s?void 0:s.id)&&m.current!==(null==s?void 0:s.id)&&r(void 0,void 0,void 0,(function*(){if(a.current)try{n.d("detaching because different track is passed"),yield v.detachVideo(m.current,a.current)}catch(r){n.w("detach video error for track",m.current,r)}})):m.current=null==s?void 0:s.id}),[null==s?void 0:s.id,v]),t((()=>{r(void 0,void 0,void 0,(function*(){(null==s?void 0:s.id)&&a.current&&(!1!==l?yield v.attachVideo(s.id,a.current):yield v.detachVideo(s.id,a.current))}))}),[s,l,v]),t((()=>()=>{r(void 0,void 0,void 0,(function*(){if(a.current&&s)try{yield v.detachVideo(s.id,a.current)}catch(r){n.w("detach video error for track",s.id,r)}}))}),[]),{videoRef:f}};export{u as useVideo};
//# sourceMappingURL=useVideo.js.map
